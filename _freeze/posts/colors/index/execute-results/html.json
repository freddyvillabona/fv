{
  "hash": "98f7d8c490a0249c76a34b68cf1bac88",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexecute:\n  message: false\n  warning: false\n  fig-show: no\ntitle: \"colores\"\nauthor: \"FV\"\ndate: \"2025-09-29\"\ncategories: [code, analysis]\nimage: \"colors.png\"\n---\n\n\n\nColores\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(glue)\nlibrary(scales)\nlibrary(showtext)\nlibrary(ggtext)\nlibrary(shadowtext)\nlibrary(maps)\nlibrary(ggpattern)\nlibrary(ggrepel)\nlibrary(patchwork)\n\nfont_add_google(\"Ubuntu\", \"Ubuntu\", regular.wt = 400, bold.wt = 700)\nshowtext_auto()\nshowtext_opts(dpi = 300)\n\n\n\ncool_gray0 <- \"#323955\"\ncool_gray1 <- \"#5a6695\"\ncool_gray2 <- \"#7e89bb\"\ncool_gray3 <- \"#a4aee2\"\ncool_gray4 <- \"#cbd5ff\"\ncool_gray5 <- \"#e7efff\"\n\ncool_red0 <- \"#A31C44\"\ncool_red1 <- \"#F01B5B\"\ncool_red2 <- \"#F43E75\"\ncool_red3 <- \"#E891AB\"\ncool_red4 <- \"#FAC3D3\"\ncool_red5 <- \"#FCE0E8\"\n\ntheme_set(\n  theme_minimal() +\n    theme(\n      # axis.line.x.bottom = element_line(color = '#474747', linewidth = .3),\n      # axis.ticks.x= element_line(color = '#474747', linewidth = .3),\n      # axis.line.y.left = element_line(color = '#474747', linewidth = .3),\n      # axis.ticks.y= element_line(color = '#474747', linewidth = .3),\n      # # panel.grid = element_line(linewidth = .3, color = 'grey90'),\n      panel.grid.major = element_blank(),\n      panel.grid.minor = element_blank(),\n      axis.ticks.length = unit(-0.15, \"cm\"),\n      plot.background = element_blank(),\n      plot.title.position = \"plot\",\n      plot.title = element_text(family = \"Ubuntu\", size = 33, face = 'bold'),\n      plot.caption = element_text(\n        size = 14,\n        color = cool_gray4,\n        margin = margin(20, 0, 0, 0),\n        hjust = 0\n      ),\n      plot.subtitle = element_text(\n        size = 16,\n        lineheight = 1.15,\n        margin = margin(5, 0, 15, 0)\n      ),\n      axis.title.x = element_markdown(\n        family = \"Ubuntu\",\n        hjust = .5,\n        size = 8,\n        color = cool_gray1\n      ),\n      axis.title.y = element_markdown(\n        family = \"Ubuntu\",\n        hjust = .5,\n        size = 8,\n        color = cool_gray1\n      ),\n      axis.text = element_text(\n        family = \"Ubuntu\",\n        hjust = .5,\n        size = 9,\n        color = cool_gray1\n      ),\n      legend.position = \"top\",\n      text = element_text(family = \"Ubuntu\", color = cool_gray1),\n      plot.margin = margin(25, 25, 25, 25)\n    )\n\n)\n\nanswers <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-07-08/answers.csv')\ncolor_ranks <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-07-08/color_ranks.csv')\nusers <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2025/2025-07-08/users.csv')\n\n\n\nanswers |> count(user_id, sort = TRUE, name = \"answers\") |> count(answers, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 183 × 2\n   answers     n\n     <int> <int>\n 1       1 17141\n 2       2 16036\n 3       3 14144\n 4       4 12141\n 5       5 10126\n 6       6  8234\n 7       7  6853\n 8       8  5709\n 9       9  4724\n10      10  3927\n# ℹ 173 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\nanswers |> count(hex, sort = TRUE, name = \"answers\") |> count(answers, sort = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 2\n  answers      n\n    <int>  <int>\n1       1 965244\n2       2  44042\n3       3   1566\n4       4     45\n5       5      1\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(plotwidgets)\ndata2plot <-\n  answers |>\n  filter(user_id %in% (users |> filter(spam_prob < 0.001) |> pull(user_id))) |>\n  left_join(\n    color_ranks |>\n      rename(rank_hex = hex) |>\n      rowwise() |>\n      mutate(hsl_rank = list(col2hsl(rank_hex))) |>\n      ungroup(),\n    by = 'rank'\n  ) |>\n  rowwise() |>\n  mutate(hsl = list(col2hsl(hex))) |>\n  ungroup()\n\n\ndata2plot <-\n  data2plot |>\n  hoist(hsl, h = 1, s = 2, l = 3) |>\n  hoist(hsl_rank, h_rank = 1, s_rank = 2, l_rank = 3)\n\n\ndata2plot2 <-\n  color_ranks |>\n  rowwise() |>\n  mutate(hsl_rank = list(col2hsl(hex))) |>\n  ungroup() |>\n  hoist(hsl_rank, h = 1, s = 2, l = 3) |>\n  filter(rank %in% data2plot$rank)\n\n\n\n# Main\np1 <-\n  data2plot |>\n  left_join(users, by = 'user_id') |>\n  filter(colorblind == 0) |>\n  filter(spam_prob < 0.001) |>\n  ggplot(aes(x = h, y = -l)) +\n  annotate(geom = 'segment', x = 0, xend = Inf, y = 0, color = cool_gray5) +\n  geom_point(aes(color = hex), size = 0.001) +\n  geom_point(data = data2plot2, aes(color = 'white'), size = 5.5) +\n  geom_point(data = data2plot2, aes(color = hex), size = 4.5) +\n  geom_text_repel(\n    data = data2plot2,\n    aes(label = str_to_sentence(color)),\n    family = \"Ubuntu\",\n    color = cool_gray0,\n    size = 3,\n    nudge_x = 5,\n    nudge_y = .1,\n    direction = \"y\",\n    hjust = \"center\",\n    bg.color = 'white',\n    segment.size = 0,\n    bg.r = 0.2\n  ) +\n  scale_color_identity() +\n  scale_y_continuous(limits = c(-1, 0)) +\n  coord_polar() +\n  labs(\n    title = \" ¿Lo sabías? Tu morado no es el mío.\",\n    subtitle = str_wrap(\n      \"Resultados de la encuesta sobre colores de xkc.\\nEn 2010, la encuesta sobre colores de xkcd pidió a cientos de miles de personas que nombraran los colores que veían, revelando las diferentes formas en que las personas perciben y etiquetan los colores.\",\n      width = 90\n    ),\n    pattern_spacing = NULL,\n    y = NULL,\n    x = NULL,\n    caption = str_wrap(\n      \"NOTA: Esta visualización ofrece una visión preliminar de los datos y puede que no refleje toda la complejidad de la realidad subyacente. SOURCE #Tidytuesday\",\n      width = 110,\n    ) |>\n      str_replace_all(\"@\", \"\\n\")\n  ) +\n  theme(\n    axis.text.x = element_blank(),\n    axis.text.y = element_blank(),\n    axis.title.x = element_blank(),\n    axis.title.y = element_blank(),\n    plot.margin = margin(0, 0, 0, 0)\n  )\n\n# Faceted (copied only because of laziness)\np2 <- data2plot |>\n  left_join(users, by = 'user_id') |>\n  filter(colorblind == 0) |>\n  filter(spam_prob < 0.001) |>\n  ggplot(aes(x = h, y = -l)) +\n  annotate(geom = 'segment', x = 0, xend = Inf, y = 0, color = cool_gray5) +\n  geom_point(aes(color = hex), size = 0.001) +\n  geom_point(data = data2plot2, aes(color = 'white'), size = 3.5) +\n  geom_point(data = data2plot2, aes(color = hex), size = 2.5) +\n  geom_text_repel(\n    data = data2plot2,\n    aes(label = str_to_sentence(color)),\n    family = \"Ubuntu\",\n    color = cool_gray0,\n    size = 3,\n    nudge_x = 5,\n    nudge_y = .1,\n    direction = \"y\",\n    hjust = \"center\",\n    bg.color = 'white',\n    segment.size = 0,\n    bg.r = 0.2\n  ) +\n  scale_color_identity() +\n  scale_y_continuous(limits = c(-1, 0)) +\n  coord_polar() +\n  facet_wrap(~color, nrow = 2) +\n  theme(\n    axis.text.x = element_blank(),\n    axis.text.y = element_blank(),\n    axis.title.x = element_blank(),\n    axis.title.y = element_blank(),\n    strip.text = element_blank(),\n    plot.margin = margin(0, 0, 0, 0)\n  )\n\n# Plot both\np1 + p2\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n![](colors.png)\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}